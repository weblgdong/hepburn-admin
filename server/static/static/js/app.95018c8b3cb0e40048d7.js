webpackJsonp([1],{"34KM":function(t,e){},"5M3/":function(t,e){},"7Pnt":function(t,e){},NHnr:function(t,e,n){"use strict";function o(){return C.a.get(N)}Object.defineProperty(e,"__esModule",{value:!0});var a={};n.d(a,"GetUserInfo",function(){return A}),n.d(a,"LoginByUsername",function(){return M}),n.d(a,"FedLogOut",function(){return R});var r={};n.d(r,"name",function(){return L});var i=n("7+uW"),s={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},staticRenderFns:[]},c=n("VU/8")({name:"app"},s,!1,function(t){n("7Pnt")},null,null).exports,l=n("/ocq"),u=n("Dd8w"),d=n.n(u),p=n("NYxO"),f={data:function(){return{loginForm:{username:"admin",password:""},loginRules:{username:[{required:!0,trigger:"blur",validator:function(t,e,n){n()}}],password:[{required:!0,trigger:"blur",validator:function(t,e,n){e.length<6?n(new Error("密码不能小于6位")):n()}}]},pwdType:"password",loading:!1,showDialog:!1}},methods:d()({},Object(p.c)({setUserName:"SET_USERNAME"}),{showPwd:function(){"password"===this.pwdType?this.pwdType="":this.pwdType="password"},handleLogin:function(){var t=this;this.$refs.loginForm.validate(function(e){e&&(e=!1,console.log(t.$store),t.$store.dispatch("LoginByUsername",t.loginForm).then(function(){t.loading=!1,t.$router.push({path:"/"})}).catch(function(){t.loading=!1}))})}})},m={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"login-container"},[n("el-form",{ref:"loginForm",staticClass:"card-box login-form",attrs:{autoComplete:"on",model:t.loginForm,rules:t.loginRules,"label-position":"left"}},[n("h3",{staticClass:"title"},[t._v("系统登录")]),t._v(" "),n("el-form-item",{attrs:{prop:"username"}},[n("span",{staticClass:"svg-container svg-container_login"},[n("i",{staticClass:"iconfont icon-user"})]),t._v(" "),n("el-input",{attrs:{name:"username",type:"text",autoComplete:"on",placeholder:"邮箱"},model:{value:t.loginForm.username,callback:function(e){t.$set(t.loginForm,"username",e)},expression:"loginForm.username"}})],1),t._v(" "),n("el-form-item",{attrs:{prop:"password"}},[n("span",{staticClass:"svg-container"},[n("i",{staticClass:"iconfont icon-password"})]),t._v(" "),n("el-input",{attrs:{name:"password",type:t.pwdType,autoComplete:"on",placeholder:"请输入密码"},nativeOn:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key))return null;t.handleLogin(e)}},model:{value:t.loginForm.password,callback:function(e){t.$set(t.loginForm,"password",e)},expression:"loginForm.password"}}),t._v(" "),n("span",{staticClass:"show-pwd",on:{click:t.showPwd}},[n("i",{staticClass:"iconfont icon-eye"})])],1),t._v(" "),n("el-button",{staticStyle:{width:"100%","margin-bottom":"30px"},attrs:{type:"primary",loading:t.loading},nativeOn:{click:function(e){e.preventDefault(),t.handleLogin(e)}}},[t._v("登录\n    ")])],1)],1)},staticRenderFns:[]},g=n("VU/8")(f,m,!1,function(t){n("T4a5")},null,null).exports,h={render:function(){var t=this.$createElement;return(this._self._c||t)("div",[this._v("\n  home\n")])},staticRenderFns:[]},v=n("VU/8")({},h,!1,function(t){n("5M3/")},"data-v-a643efd6",null).exports,w=n("mtWM"),_=n.n(w),b={data:function(){return{tableData:[],loading:!0}},created:function(){this.getAllData()},computed:d()({},Object(p.b)(["name"])),methods:{handleDelete:function(t,e){var n=this,o=this;console.log(e._id),this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){o.removeVideo(e._id)}).catch(function(){n.$message({type:"info",message:"已取消删除"})})},formatter:function(t,e){return t.address},removeVideo:function(t){var e=this;_.a.get("http://lgdong.cn/removeBlessing",{params:{id:t}}).then(function(t){e.$message({type:"success",message:"删除成功!"}),e.getAllData()}).catch(function(t){console.log(t)})},getAllData:function(){var t=this;_.a.post("http://lgdong.cn/allData").then(function(e){t.loading=!1,t.tableData=e.data}).catch(function(t){console.log(t)})}}},y={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-container",{staticClass:"app-wrapper"},[n("el-container",[n("el-header",{staticStyle:{"text-align":"right","font-size":"12px"}},[n("span",[t._v(t._s(t.name))])]),t._v(" "),n("el-main",[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.tableData}},[n("el-table-column",{attrs:{label:"头像",width:"300"},scopedSlots:t._u([{key:"default",fn:function(t){return[n("img",{attrs:{src:t.row.avatarUrl,height:"50px"}})]}}])}),t._v(" "),n("el-table-column",{staticStyle:{width:"50%"},attrs:{label:"昵称"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{staticStyle:{"margin-left":"10px"}},[t._v(t._s(e.row.nickName))])]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(n){t.handleDelete(e.$index,e.row)}}},[t._v("删除")])]}}])})],1)],1)],1)],1)},staticRenderFns:[]},k=n("VU/8")(b,y,!1,function(t){n("fB6a")},"data-v-37e1e030",null).exports;i.default.use(l.a);var E=new l.a({routes:[{path:"/",redirect:"/dashboard"},{path:"/login",component:g},{path:"/index",component:v},{path:"/dashboard",component:k}]}),T=n("zL8q"),x=n.n(T),F=n("//Fk"),S=n.n(F),O=n("lbHh"),C=n.n(O),N="Admin-Token",$=_.a.create({baseURL:Object({NODE_ENV:"production"}).BASE_API,timeout:5e3});$.interceptors.request.use(function(t){return q.getters.token&&(t.headers["X-Token"]=o()),t},function(t){console.log(t),S.a.reject(t)}),$.interceptors.response.use(function(t){return t},function(t){return console.log("err"+t),Object(T.Message)({message:t.message,type:"error",duration:5e3}),S.a.reject(t)});var D,U=$,A=function(t){var e=t.commit;t.state;return new S.a(function(t,n){(function(t){return console.log("token",t),U({url:"http://lgdong.cn:3000/admin/vToken",method:"get",params:{token:t}})})(o()).then(function(o){o.data.status||n(new Error("something bad happened"));var a=o.data;e("SET_NAME",a.username),t(o)}).catch(function(t){n(t)})})},M=function(t,e){var n=t.commit,o=e.username.trim();return new S.a(function(t,a){(function(t,e){return U({url:"http://lgdong.cn:3000/admin/login",method:"post",data:{username:t,password:e}})})(o,e.password).then(function(e){var o=e.data;n("SET_TOKEN",o.token),function(t){C.a.set(N,t)}(e.data.token),t()}).catch(function(t){a(t)})})},R=function(t){var e=t.commit;return new S.a(function(t){e("SET_TOKEN",""),C.a.remove(N),t()})},L=function(t){return t.name},B={name:"",token:""},j=n("bOdI"),V=n.n(j),P=(D={},V()(D,"SET_NAME",function(t,e){t.name=e}),V()(D,"SET_TOKEN",function(t,e){t.token=e}),D);n("sax8");i.default.use(p.a);var q=new p.a.Store({actions:a,getters:r,state:B,mutations:P,strict:!1,plugins:[]});n("tvR6"),n("34KM");console.log(E);var K=["/login","/authredirect"];E.beforeEach(function(t,e,n){o()?q.dispatch("GetUserInfo").then(function(t){console.log(t)}).catch(function(){q.dispatch("FedLogOut").then(function(){T.Message.error("验证失败,请重新登录"),n({path:"/login"})})}):-1!==K.indexOf(t.path)?n():n("/login"),n()}),i.default.use(x.a),i.default.config.productionTip=!1,new i.default({el:"#app",store:q,router:E,template:"<App/>",components:{App:c}})},T4a5:function(t,e){},fB6a:function(t,e){},tvR6:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.95018c8b3cb0e40048d7.js.map
